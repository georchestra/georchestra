<div ng-if="groups.isRoot">
  <div class="alert alert-info">
    <a ng-link="users({id: 'all'})" translate>group.allusers</a>
    <br>
    <hr>
    <a href="" class="btn btn-default" translate>group.newuser</a>
    <a href="" class="btn btn-default" translate>group.newgroup</a>
  </div>

  <input ng-if="groups.isRoot" ng-model="groups.q" class="form-control input-sm" placeholder="Search groups">

  <h5 ng-if="groups.q == ''">System groups</h5>
  <div ng-repeat="group in groups.adminList" ng-if="groups.q == ''">
    <strong ng-if="(groups.activeGroup.cn == group.cn)">
      {{::group | unprefix: groups.prefix}} ({{::group.users.length}})
    </strong>
    <a ng-link="users({id: group.cn})" ng-if="(groups.activeGroup.cn != group.cn)">
      {{::group.cn}}
     ({{::group.users.length}})
   </a>
  </div>
</div>

<h5 ng-if="groups.isRoot && groups.q == ''">Application groups</h5>

<div ng-if="groups.q == ''">

  <a ng-if="groups.enableBack" class="btn btn-default btn-xs" ng-link="users({id: groups.prefix.parent})">
    Â«
  </a>
  <span ng-if="groups.enableBack">{{groups.prefix.cn || 'Tous'}}</span>

  <div ng-repeat="group in groups.tree" ng-if="groups.filter(group, groups.activeGroup)">

    <strong ng-if="(groups.activeGroup.cn == group.cn) && (group.children.length == 0)">
      {{::group | unprefix: groups.prefix}} ({{::group.users.length}})
    </strong>
    <a ng-link="users({id: group.cn})" title={{::group.description}}
      ng-if="(groups.activeGroup.cn != group.cn) && (groups.prefix.cn.indexOf(group.cn)!=0)">
      <span ng-if="group.children.length > 0">+</span>
      {{::group | unprefix: groups.prefix}} ({{::group.users.length}})
    </a>

    <groups groups="group.children" active-group="groups.activeGroup" index="groups.index"
    ng-if="groups.isExpanded(group, groups.activeGroup)"></groups>

  </div>

</div>

<div ng-repeat="(key, group) in groups.index" ng-if="groups.isRoot && groups.q != ''">
  <a ng-link="users({id: group.cn})" title={{::group.description}}
      ng-if="group.cn.toLowerCase().indexOf(groups.q.toLowerCase()) >= 0">
    {{::group.cn}} ({{::group.users.length}})
  </a>
</div>
