<?xml version="1.0" encoding="ISO-8859-1"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
  <modelVersion>4.0.0</modelVersion>
  <parent>
    <groupId>org.georchestra</groupId>
    <artifactId>geoserver-root</artifactId>
    <version>17.06-SNAPSHOT</version>
  </parent>
  <artifactId>geoserver-webapp</artifactId>
  <packaging>war</packaging>
  <name>geOrchestra GeoServer Web Application</name>
  <properties>
    <gs.unpack.dir>${project.build.directory}/geoserver-unpacked-webapp</gs.unpack.dir>
    <packageName>georchestra-geoserver</packageName>
  </properties>
  <dependencies>
    <dependency>
      <groupId>log4j</groupId>
      <artifactId>apache-log4j-extras</artifactId>
      <version>1.2.17</version>
      <type>jar</type>
      <scope>runtime</scope>
    </dependency>
  </dependencies>
  <build>
    <finalName>geoserver-${server}</finalName>
    <plugins>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-clean-plugin</artifactId>
        <version>2.4.1</version>
        <executions>
          <execution>
            <phase>validate</phase>
            <goals>
              <goal>clean</goal>
            </goals>
          </execution>
        </executions>
      </plugin>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-dependency-plugin</artifactId>
        <executions>
          <execution>
            <id>unpack-geoserver-war</id>
            <goals>
              <goal>unpack</goal>
            </goals>
            <phase>generate-sources</phase>
            <configuration>
              <excludes>${geoserver.war.excludes}</excludes>
              <artifactItems>
                <artifactItem>
                  <groupId>${geoserver.webapp.groupId}</groupId>
                  <artifactId>${geoserver.webapp.artifactId}</artifactId>
                  <version>${geoserver.webapp.version}</version>
                  <type>jar</type>
                </artifactItem>
              </artifactItems>
              <outputDirectory>${gs.unpack.dir}</outputDirectory>
            </configuration>
          </execution>
        </executions>
      </plugin>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-war-plugin</artifactId>
        <version>2.2</version>
        <configuration>
          <warSourceDirectory>${gs.unpack.dir}</warSourceDirectory>
          <webXml>${gs.unpack.dir}/WEB-INF/web.xml</webXml>
          <filter>${confdir}/${project.artifactId}/maven.filter</filter>
          <webResources>
            <resource>
              <filtering>true</filtering>
              <directory>${basedir}/src/main/filtered-resources/</directory>
            </resource>
            <resource>
              <filtering>false</filtering>
              <directory>${basedir}/src/main/webapp/</directory>
            </resource>
            <resource>
              <filtering>false</filtering>
              <directory>${confdir}/${project.artifactId}</directory>
              <excludes>
                <exclude>maven.filter</exclude>
                <exclude>README</exclude>
              </excludes>
            </resource>
          </webResources>
          <packagingExcludes>
            <!--
                 wicket 1.4.12 explicitely needs slf4j 1.5.8, the build system
                 is made so that we end up with both versions in the WAR,
                 polluting the classpath.
                 Best way to address the issue is to exclude the problematic dependency,
                 note that this is what the official doc does:
                 https://maven.apache.org/plugins/maven-war-plugin/examples/including-excluding-files-from-war.html
             -->
            WEB-INF/lib/slf4j-api-1.5.8.jar
          </packagingExcludes>
        </configuration>
      </plugin>
      <plugin>
        <groupId>org.eclipse.jetty</groupId>
        <artifactId>jetty-maven-plugin</artifactId>
        <version>9.2.11.v20150529</version>
        <configuration>
          <webApp><contextPath>/geoserver/</contextPath></webApp>
          <scanIntervalSeconds>5</scanIntervalSeconds>
          <httpConnector>
            <port>8380</port>
          </httpConnector>
        </configuration>
      </plugin>
    </plugins>
  </build>
  <profiles>
    <profile>
      <id>bxml</id>
      <dependencies>
        <dependency>
          <groupId>org.gvsig</groupId>
          <artifactId>bxml-geoserver</artifactId>
          <version>1.0-SNAPSHOT</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>kml</id>
      <dependencies>
        <dependency>
          <groupId>org.geotools</groupId>
          <artifactId>gt-kml</artifactId>
          <version>${gt.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>arcsde</id>
      <dependencies>
        <dependency>
          <groupId>org.geoserver.extension</groupId>
          <artifactId>gs-arcsde</artifactId>
          <version>${gs.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>sdeLibs</id>
      <dependencies>
        <dependency>
          <groupId>com.esri</groupId>
          <artifactId>jsde_sdk</artifactId>
          <version>${sde.version}</version>
        </dependency>
        <dependency>
          <groupId>com.esri</groupId>
          <artifactId>jpe_sdk</artifactId>
          <version>${sde.version}</version>
        </dependency>
        <dependency>
          <groupId>com.ibm.icu</groupId>
          <artifactId>icu4j</artifactId>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>sqlserver</id>
      <dependencies>
        <dependency>
          <groupId>org.geoserver.extension</groupId>
          <artifactId>gs-sqlserver</artifactId>
          <version>${gs.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>oracle</id>
      <dependencies>
        <dependency>
          <groupId>org.geoserver.extension</groupId>
          <artifactId>gs-oracle</artifactId>
          <version>${gs.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>mysql</id>
      <dependencies>
        <dependency>
          <groupId>org.geoserver.extension</groupId>
          <artifactId>gs-mysql</artifactId>
          <version>${gs.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>wfsv</id>
      <activation>
        <property>
          <name>wfsv</name>
        </property>
      </activation>
      <dependencies>
        <dependency>
          <groupId>org.geoserver</groupId>
          <artifactId>gs-wfsv</artifactId>
          <version>${gs.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>h2</id>
      <dependencies>
        <dependency>
          <groupId>org.geoserver.extension</groupId>
          <artifactId>gs-h2</artifactId>
          <version>${gs.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>validation</id>
      <dependencies>
        <dependency>
          <groupId>org.geoserver.extension</groupId>
          <artifactId>gs-validation</artifactId>
          <version>${gs.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>app-schema</id>
      <dependencies>
        <dependency>
          <groupId>org.geotools</groupId>
          <artifactId>gt-app-schema</artifactId>
          <version>${gt.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>geosearch</id>
      <dependencies>
        <dependency>
          <groupId>org.geoserver.extension</groupId>
          <artifactId>gs-geosearch</artifactId>
          <version>${gs.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>geopkg</id>
      <dependencies>
        <dependency>
          <groupId>org.geoserver.community</groupId>
          <artifactId>gs-geopkg</artifactId>
          <version>${gs.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>colormap</id>
      <dependencies>
        <dependency>
          <groupId>org.geoserver.community</groupId>
          <artifactId>gs-colormap</artifactId>
          <version>${gs.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>imagemosaic-jdbc</id>
      <dependencies>
        <dependency>
          <groupId>org.geoserver.extension</groupId>
          <artifactId>gs-imagemosaic-jdbc</artifactId>
          <version>${gs.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>feature-pregeneralized</id>
      <dependencies>
        <dependency>
          <groupId>org.geoserver.extension</groupId>
          <artifactId>gs-feature-pregeneralized</artifactId>
          <version>${gs.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>printing</id>
      <dependencies>
        <dependency>
          <groupId>org.geoserver.community</groupId>
          <artifactId>gs-printing</artifactId>
          <version>${gs.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>scriptlet</id>
      <dependencies>
        <dependency>
          <groupId>org.geoserver.community</groupId>
          <artifactId>gs-scriptlet</artifactId>
          <version>${gs.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>dxf</id>
      <dependencies>
        <dependency>
          <groupId>org.geoserver.extension</groupId>
          <artifactId>gs-dxf-core</artifactId>
          <version>${gs.version}</version>
        </dependency>
        <dependency>
          <groupId>org.geoserver.extension</groupId>
          <artifactId>gs-dxf-wps</artifactId>
          <version>${gs.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>istyler</id>
      <dependencies>
        <dependency>
          <groupId>org.geoserver.community</groupId>
          <artifactId>gs-istyler</artifactId>
          <version>${gs.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>importer</id>
      <dependencies>
        <dependency>
          <groupId>org.geoserver.importer</groupId>
          <artifactId>gs-importer-core</artifactId>
          <version>${gs.version}</version>
        </dependency>
        <dependency>
          <groupId>org.geoserver.importer</groupId>
          <artifactId>gs-importer-web</artifactId>
          <version>${gs.version}</version>
        </dependency>
        <dependency>
          <groupId>org.geoserver.importer</groupId>
          <artifactId>gs-importer-rest</artifactId>
          <version>${gs.version}</version>
        </dependency>
        <dependency>
          <groupId>org.geoserver.importer</groupId>
          <artifactId>gs-importer-bdb</artifactId>
          <version>${gs.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>sldservice</id>
      <dependencies>
        <dependency>
          <groupId>org.geoserver.community</groupId>
          <artifactId>gs-sldservice</artifactId>
          <version>${gs.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>proxy</id>
      <dependencies>
        <dependency>
          <groupId>org.geoserver.community</groupId>
          <artifactId>gs-proxy</artifactId>
          <version>${gs.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>control-flow</id>
      <dependencies>
        <dependency>
          <groupId>org.geoserver.extension</groupId>
          <artifactId>gs-control-flow</artifactId>
          <version>${gs.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>python</id>
      <dependencies>
        <dependency>
          <groupId>org.geoserver.community</groupId>
          <artifactId>gs-python</artifactId>
          <version>${gs.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>pyramid</id>
      <dependencies>
        <dependency>
          <groupId>org.geotools</groupId>
          <artifactId>gt-imagepyramid</artifactId>
          <version>${gt.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>charts</id>
      <dependencies>
        <dependency>
          <groupId>org.geoserver.extension</groupId>
          <artifactId>gs-charts</artifactId>
          <version>${gs.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>wps</id>
      <dependencies>
        <dependency>
          <groupId>org.geoserver.extension</groupId>
          <artifactId>gs-wps-core</artifactId>
          <version>${gs.version}</version>
        </dependency>
        <dependency>
          <groupId>org.geoserver.extension</groupId>
          <artifactId>gs-web-wps</artifactId>
          <version>${gs.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>css</id>
      <dependencies>
        <dependency>
          <groupId>org.geoserver.extension</groupId>
          <artifactId>gs-css</artifactId>
          <version>${gs.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>gss</id>
      <dependencies>
        <dependency>
          <groupId>org.geoserver.community</groupId>
          <artifactId>gs-gss</artifactId>
          <version>${gs.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>ftp</id>
      <dependencies>
        <dependency>
          <groupId>org.geoserver.community</groupId>
          <artifactId>gs-ftp</artifactId>
          <version>${gs.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>monitor</id>
      <activation>
        <property>
          <name>monitoring</name>
        </property>
      </activation>
      <dependencies>
        <dependency>
          <groupId>org.geoserver.extension</groupId>
          <artifactId>gs-monitor-core</artifactId>
          <version>${gs.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>monitor-hibernate</id>
      <activation>
        <property>
          <name>monitoring</name>
        </property>
      </activation>
      <dependencies>
        <dependency>
          <groupId>org.geoserver.extension</groupId>
          <artifactId>gs-monitor-hibernate</artifactId>
          <version>${gs.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>ogr</id>
      <dependencies>
        <dependency>
          <groupId>org.geoserver.extension</groupId>
          <artifactId>gs-ogr</artifactId>
          <version>${gs.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>dbconfig</id>
      <dependencies>
        <dependency>
          <groupId>org.geoserver.community</groupId>
          <artifactId>gs-dbconfig</artifactId>
          <version>${gs.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>spatialite</id>
      <dependencies>
        <dependency>
          <groupId>org.geoserver.community</groupId>
          <artifactId>gs-spatialite</artifactId>
          <version>${gs.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>sextante</id>
      <dependencies>
        <dependency>
          <groupId>org.geoserver.community</groupId>
          <artifactId>gs-wps-sextante</artifactId>
          <version>${gs.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>inspire</id>
      <dependencies>
        <dependency>
          <groupId>org.geoserver.extension</groupId>
          <artifactId>gs-inspire</artifactId>
          <version>${gs.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>querylayer</id>
      <dependencies>
        <dependency>
          <groupId>org.geoserver.extension</groupId>
          <artifactId>gs-querylayer</artifactId>
          <version>${gs.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>gdal</id>
      <dependencies>
        <dependency>
          <groupId>org.geoserver.extension</groupId>
          <artifactId>gs-gdal</artifactId>
          <version>${gs.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>sfs</id>
      <dependencies>
        <dependency>
          <groupId>org.geoserver.community</groupId>
          <artifactId>gs-simpleFeatureService</artifactId>
          <version>${gs.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>sfs-store</id>
      <dependencies>
        <dependency>
          <groupId>org.geotools</groupId>
          <artifactId>gt-sfs</artifactId>
          <version>${gt.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>teradata</id>
      <dependencies>
        <dependency>
          <groupId>org.geoserver.extension</groupId>
          <artifactId>gs-teradata</artifactId>
          <version>${gs.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>cas</id>
      <dependencies>
        <dependency>
          <groupId>org.geoserver.security</groupId>
          <artifactId>gs-sec-cas</artifactId>
          <version>${gs.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>imagecollection</id>
      <dependencies>
        <dependency>
          <groupId>org.geotools</groupId>
          <artifactId>gt-imagecollection</artifactId>
          <version>${gt.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>feature-aggregate</id>
      <dependencies>
        <dependency>
          <groupId>org.geoserver.community</groupId>
          <artifactId>gs-feature-aggregate</artifactId>
          <version>${gs.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>authkey</id>
      <dependencies>
        <dependency>
          <groupId>org.geoserver.community</groupId>
          <artifactId>gs-authkey</artifactId>
          <version>${gs.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>gt-ogr</id>
      <dependencies>
        <dependency>
          <groupId>org.geotools</groupId>
          <artifactId>gt-ogr</artifactId>
          <version>${gt.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>csw</id>
      <dependencies>
        <dependency>
          <groupId>org.geoserver.csw</groupId>
          <artifactId>gs-csw-core</artifactId>
          <version>${gs.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>csw-simple</id>
      <dependencies>
        <dependency>
          <groupId>org.geoserver.csw</groupId>
          <artifactId>gs-csw-simple-store</artifactId>
          <version>${gs.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>jdbcconfig</id>
      <dependencies>
        <dependency>
          <groupId>org.geoserver.community</groupId>
          <artifactId>gs-jdbcconfig</artifactId>
          <version>${gs.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>script-py</id>
      <activation>
        <property>
          <name>script</name>
        </property>
      </activation>
      <dependencies>
        <dependency>
          <groupId>org.geoserver.script</groupId>
          <artifactId>gs-script-py</artifactId>
          <version>${gs.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>script-js</id>
      <activation>
        <property>
          <name>script</name>
        </property>
      </activation>
      <dependencies>
        <dependency>
          <groupId>org.geoserver.script</groupId>
          <artifactId>gs-script-js</artifactId>
          <version>${gs.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>script-bsh</id>
      <activation>
        <property>
          <name>script</name>
        </property>
      </activation>
      <dependencies>
        <dependency>
          <groupId>org.geoserver.script</groupId>
          <artifactId>gs-script-bsh</artifactId>
          <version>${gs.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>script-rb</id>
      <activation>
        <property>
          <name>script</name>
        </property>
      </activation>
      <dependencies>
        <dependency>
          <groupId>org.geoserver.script</groupId>
          <artifactId>gs-script-rb</artifactId>
          <version>${gs.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>script-groovy</id>
      <activation>
        <property>
          <name>script</name>
        </property>
      </activation>
      <dependencies>
        <dependency>
          <groupId>org.geoserver.script</groupId>
          <artifactId>gs-script-groovy</artifactId>
          <version>${gs.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>xslt</id>
      <activation>
        <property>
          <name>xslt</name>
        </property>
      </activation>
      <dependencies>
        <dependency>
          <groupId>org.geoserver</groupId>
          <artifactId>gs-xslt</artifactId>
          <version>${gs.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>wcs20</id>
      <activation>
        <property>
          <name>wcs20</name>
        </property>
      </activation>
      <dependencies>
        <dependency>
          <groupId>org.geoserver.community</groupId>
          <artifactId>gs-wcs2_0</artifactId>
          <version>${gs.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>w3ds</id>
      <dependencies>
        <dependency>
          <groupId>org.geoserver.community</groupId>
          <artifactId>gs-w3ds</artifactId>
          <version>${gs.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>libjpeg-turbo</id>
      <dependencies>
        <dependency>
          <groupId>org.geoserver.extension</groupId>
          <artifactId>gs-libjpeg-turbo</artifactId>
          <version>${gs.version}</version>
        </dependency>
      </dependencies>
    </profile>
    <profile>
      <id>debianPackage</id>
      <build>
        <finalName>geoserver-generic</finalName>
        <plugins>
          <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-scm-plugin</artifactId>
            <version>1.9.4</version>
            <configuration>
              <checkoutDirectory>${project.build.directory}/deb/etc/georchestra</checkoutDirectory>
              <connectionUrl>scm:git:https://github.com/georchestra/datadir.git</connectionUrl>
              <pushChanges>false</pushChanges>
            </configuration>
            <executions>
              <execution>
                <id>checkout-deb-default-datadir</id>
                <phase>process-resources</phase>
                <goals>
                  <goal>checkout</goal>
                </goals>
              </execution>
            </executions>
          </plugin>
          <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-antrun-plugin</artifactId>
            <version>1.6</version>
            <executions>
              <execution>
                <id>remove-useless-directories</id>
                <phase>package</phase>
                <configuration>
                  <target>
                    <delete includeemptydirs="true">
                      <fileset dir="${project.build.directory}/deb/etc/georchestra">
                        <include name="**/*" />
                        <exclude name="geoserver/**" />
                      </fileset>
                    </delete>
                 </target>
                </configuration>
                <goals>
                  <goal>run</goal>
                </goals>
              </execution>
              <execution>
                <id>fix-permissions</id>
                <phase>package</phase>
                <configuration>
                  <target>
                    <chmod perm="ugo+x">
                      <fileset dir="${basedir}/target/deb">
                        <include name="**/bin/**"/>
                        <include name="**/sbin/**"/>
                        <include name="DEBIAN/post*"/>
                        <include name="DEBIAN/pre*"/>
                      </fileset>
                    </chmod>
                  </target>
                </configuration>
                <goals><goal>run</goal></goals>
              </execution>
            </executions>
          </plugin>
          <plugin>
            <groupId>net.sf.debian-maven</groupId>
            <artifactId>debian-maven-plugin</artifactId>
            <version>1.0.6</version>
            <configuration>
              <packageName>${packageName}</packageName>
              <packageDescription>geOrchestra GeoServer</packageDescription>
              <packageDependencies>
                <packageDependency>debconf</packageDependency>
              </packageDependencies>
              <projectUrl>http://www.georchestra.org/</projectUrl>
              <projectOrganization>geOrchestra</projectOrganization>
              <maintainerName>PSC</maintainerName>
              <maintainerEmail>psc@georchestra.org</maintainerEmail>
              <excludeAllDependencies>true</excludeAllDependencies>
              <snapshotRevisionFile>${project.build.directory}</snapshotRevisionFile>
            </configuration>
          </plugin>
        </plugins>
      </build>
    </profile>
    <profile>
      <id>rpmPackage</id>
      <build>
        <finalName>geoserver-generic</finalName>
        <plugins>
          <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-scm-plugin</artifactId>
            <version>1.9.4</version>
            <configuration>
              <checkoutDirectory>${project.build.directory}/deb/etc/georchestra</checkoutDirectory>
              <connectionUrl>scm:git:https://github.com/georchestra/datadir.git</connectionUrl>
              <pushChanges>false</pushChanges>
            </configuration>
            <executions>
              <execution>
                <id>checkout-deb-default-datadir</id>
                <phase>process-resources</phase>
                <goals>
                  <goal>checkout</goal>
                </goals>
              </execution>
            </executions>
          </plugin>
          <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-antrun-plugin</artifactId>
            <version>1.6</version>
            <executions>
              <execution>
                <configuration>
                  <target>
                    <delete includeemptydirs="true">
                      <fileset dir="${project.build.directory}/deb/etc/georchestra">
                        <include name="**/*" />
                        <exclude name="geoserver/**" />
                      </fileset>
                    </delete>
                 </target>
                </configuration>
                <id>remove-useless-directories</id>
                <phase>package</phase>
                <goals>
                  <goal>run</goal>
                </goals>
              </execution>
            </executions>
          </plugin>
          <plugin>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>rpm-maven-plugin</artifactId>
            <version>2.1.3</version>
            <executions>
              <execution>
                <id>generate-rpm</id>
                <goals>
                  <goal>rpm</goal>
                </goals>
              </execution>
            </executions>
            <configuration>
              <name>${packageName}</name>
              <sourceEncoding>UTF-8</sourceEncoding>
              <group>Applications/Internet</group>
              <keyname>${rpm.gpg.key}</keyname>
              <mappings>
                <mapping>
                  <directory>/usr/share/lib/georchestra-geoserver</directory>
                  <sources>
                    <source>
                      <location>${project.build.directory}</location>
                      <includes>
                        <include>geoserver-generic.war</include>
                      </includes>
                    </source>
                  </sources>
                </mapping>
                <mapping>
                  <directory>/</directory>
                  <sources>
                    <source>
                      <location>${project.build.directory}/deb</location>
                    </source>
                  </sources>
                </mapping>
              </mappings>
            </configuration>
          </plugin>
        </plugins>
      </build>
    </profile>

    <profile>
      <id>docker</id>
      <properties>
        <dockerImageName>georchestra/geoserver</dockerImageName>
        <dockerDatadirScmUrl>scm:git:https://github.com/georchestra/datadir.git</dockerDatadirScmUrl>
        <dockerDatadirScmVersion>docker-master</dockerDatadirScmVersion>
        <dockerGeoserverDatadirScmUrl>scm:git:https://github.com/georchestra/geoserver_minimal_datadir.git</dockerGeoserverDatadirScmUrl>
        <dockerGeoserverDatadirScmVersion>master</dockerGeoserverDatadirScmVersion>
      </properties>
      <build>
        <finalName>geoserver</finalName>
        <plugins>
          <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-scm-plugin</artifactId>
            <version>1.9.4</version>
            <executions>
              <execution>
                <id>checkout-docker-default-datadir</id>
                <phase>process-resources</phase>
                <configuration>
                  <checkoutDirectory>${project.build.directory}/datadir/</checkoutDirectory>
                  <connectionUrl>${dockerDatadirScmUrl}</connectionUrl>
                  <pushChanges>false</pushChanges>
                  <scmVersion>${dockerDatadirScmVersion}</scmVersion>
                  <scmVersionType>branch</scmVersionType>
                </configuration>
                <goals>
                  <goal>checkout</goal>
                </goals>
              </execution>
              <execution>
                <id>checkout-docker-default-geoserver-datadir</id>
                <phase>process-resources</phase>
                <configuration>
                  <checkoutDirectory>${project.build.directory}/geoserver_minimal_datadir/</checkoutDirectory>
                  <connectionUrl>${dockerGeoserverDatadirScmUrl}</connectionUrl>
                  <pushChanges>false</pushChanges>
                  <scmVersion>${dockerGeoserverDatadirScmVersion}</scmVersion>
                  <scmVersionType>branch</scmVersionType>
                </configuration>
                <goals>
                  <goal>checkout</goal>
                </goals>
              </execution>
            </executions>
          </plugin>
          <plugin>
            <groupId>com.spotify</groupId>
            <artifactId>docker-maven-plugin</artifactId>
            <version>0.3.8</version>
            <configuration>
              <imageName>${dockerImageName}</imageName>
              <dockerDirectory>${project.basedir}/src/docker</dockerDirectory>
              <resources>
                <resource>
                  <targetPath>/var/lib/jetty/webapps</targetPath>
                  <directory>${project.build.directory}</directory>
                  <include>geoserver.war</include>
                </resource>
                <resource>
                  <targetPath>/etc/georchestra</targetPath>
                  <directory>${project.build.directory}/datadir</directory>
                  <include>geoserver/**</include>
                </resource>
                <resource>
                  <targetPath>/var/local/geoserver.orig/</targetPath>
                  <directory>${project.build.directory}/geoserver_minimal_datadir/</directory>
                </resource>
              </resources>
              <serverId>docker-hub</serverId>
              <registryUrl>https://index.docker.io/v1/</registryUrl>
            </configuration>
            <dependencies>
              <dependency>
                <groupId>com.google.guava</groupId>
                <artifactId>guava</artifactId>
                <version>19.0</version>
              </dependency>
            </dependencies>
          </plugin>
        </plugins>
      </build>
    </profile>
    <profile>
      <id>geofence</id>
      <properties>
        <packageName>georchestra-geoserver-geofence</packageName>
        <dockerGeoserverDatadirScmVersion>geofence</dockerGeoserverDatadirScmVersion>
        <dockerImageName>georchestra/geoserver:${geofence}-${project.parent.version}</dockerImageName>
      </properties>
    </profile>

  </profiles>
</project>
